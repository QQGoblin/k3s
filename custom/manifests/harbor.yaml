apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: harbor
  namespace: kube-system
spec:
  targetNamespace: registry
  createNamespace: true
  chart: https://%{KUBERNETES_API}%/static/charts/harbor-1.14.2.tgz
  set:
    "nginx.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/nginx-photon"
    "portal.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-portal"
    "core.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-core"
    "jobservice.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-jobservice"
    "registry.registry.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/registry-photon"
    "registry.controller.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-registryctl"
    "trivy.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/trivy-adapter-photon"
    "database.internal.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-db"
    "redis.internal.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/redis-photon"
    "exporter.image.repository": "%{SYSTEM_DEFAULT_REGISTRY}%rancher/harbor-exporter"
  valuesContent: |-
    externalURL: https://registry.develop.com
    trivy:
      enabled: false
    expose:
      type: ingress
      tls:
        enabled: true
        certSource: secret
        secret:
          secretName: "harbor-tls-secret"
      ingress:
        hosts:
          core: registry.develop.com
---
apiVersion: v1
kind: Secret
metadata:
  name: harbor-tls-secret
  namespace: registry
type: Opaque
data:
  # ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVjVENDQXRtZ0F3SUJBZ0lRV09TVEZZTmt2SU5XNHFHMkVGdW1EVEFOQmdrcWhraUc5dzBCQVFzRkFEQlIKTVI0d0hBWURWUVFLRXhWdGEyTmxjblFnWkdWMlpXeHZjRzFsYm5RZ1EwRXhFekFSQmdOVkJBc01Dbkp2YjNSQQpibTlrWlRFeEdqQVlCZ05WQkFNTUVXMXJZMlZ5ZENCeWIyOTBRRzV2WkdVeE1CNFhEVEkwTURZeU5qQXlNVEUxCk1Gb1hEVE0wTURZeU5qQXlNVEUxTUZvd1VURWVNQndHQTFVRUNoTVZiV3RqWlhKMElHUmxkbVZzYjNCdFpXNTAKSUVOQk1STXdFUVlEVlFRTERBcHliMjkwUUc1dlpHVXhNUm93R0FZRFZRUUREQkZ0YTJObGNuUWdjbTl2ZEVCdQpiMlJsTVRDQ0FhSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnR1BBRENDQVlvQ2dnR0JBTWJhNWdTSGlKRmtPUi8zCkJCTTRjcXlrMEU4eXNGbjR2dkZYSm5kSTQrUHpWZ1Z1cHlpZGhxcWxxMkNiUHBDYjlqbGdDYVZzdERLb3BWcnoKVlB4aWVDeG5hWWlsUVdTNzNvRGNxcEJ5MXJlL056b1RVQlFEeU5tWlV1UW94QkQza01nc2Rrelo3TC8zd0FaSApVTWdVaTRPOGtkN0pScFBpQTA4M2hqR2xtQTNpSnQ3MExzcjc0SzJDZDRvWGZiM0NDVld3aE9BdGpZZzVDZk0wCmxmUEpGZ2pWMU5QZjlHNUNSM2tkSUtIVXQ0WHp0NWJWK3JscGhES0dOcGg1MnUvakpFRDdUZE1WeHYxK2tLQlQKTld5QjRKMjdMMzVlZkRQM21ST0NLdDdzRW9ic3U3T2YyZTJnV1FxK3hScDRPcnZ6SDgxdHAvakNLVUJqZ2lXMgpDVDJxWkQ3dGtaUEVpM2ExYkxzcEoxVElaWm9Gbi84ODZ1QlI3THNUczJyMThOdTFkamVsVll1UDVpaFJmemdOCktva1pjbW9iTytvVVFTV3d3a2FCV1dNaDZ6OVdrYUsvcUVBR1JMS2k4Rm84OStyZUNRUXZJRjJ0bzQrRU5YSVYKeW9jVW9QL1laNHk0SGh0SHVVMXNiS2dZNmdtcW5nd0xaZytobEpCWThtYXRPSVkveHdJREFRQUJvMFV3UXpBTwpCZ05WSFE4QkFmOEVCQU1DQWdRd0VnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFEQWRCZ05WSFE0RUZnUVUvV05sCkFBV3VWVkluRjVBMkRKYk9CMzhPbjI0d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dHQkFIMkZxK0xqTDF1aGRncFkKWTR6U0ErRGYxOEdTSG05SG9BQ0Ivc2l0MlkxSlZkMVQ3emFYZVhFdS9odkVRK3ZKKzlnV21wemRQN0hoRnFjaQpEZWYwNjl5Z2NBek9SbmIzbytzWUdCQSsvQU5JS25LSDE1UlFPN1pRNVhIUTZMejZSR3AzM1lUM0NwRWQ2WGxlCkEwWC9zR0xhMEJGTG5GL0V2TFd0cVB3NzlTOXdHVHNLTmpPTXdMTkRnUEp6ZGF3ZS8rRFFhTlQvVk5EcW0xam4Kemx3c2UySmhmcTgxeE9oRENVeVlqU3d2YnNLcHRxZlhyNUdxUmJ2VzU4Qlh3eGZtWDVhTVN3UVNQM0FaK2JPWgp3YlZwajRFcXU1bzFRaFJlQkRDUVZOa2JJWTdINHo5NjlXRDZBcGp2WW94aUJZSVlEZU5NMDdpK1BmeXhTRW8xCjRCMUFnaFRlSjVsbzRYdERqa3hMNmZTZUJUZm5sZ3JMT29ZOVB0VlVZZ09CWTQwUUM0L3ZaQjB1UVZPSEhMTUsKbUlSTThQSUljRXYwbWdqWFRIUlEwUGZONTU2UGpQVHZtU2lIYkhaVG9zZWFKWmxXejgyVENFc0xveUtsZUZwdwo2alFYRThHNnl1eTBqV0xMRmJudWVSc3hIVExKRzkzcHFCS04rOEtub3hHQXhjeVhMQT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  # ca.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUcvQUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQnVZd2dnYmlBZ0VBQW9JQmdRREcydVlFaDRpUlpEa2YKOXdRVE9IS3NwTkJQTXJCWitMN3hWeVozU09QajgxWUZicWNvbllhcXBhdGdtejZRbS9ZNVlBbWxiTFF5cUtWYQo4MVQ4WW5nc1oybUlwVUZrdTk2QTNLcVFjdGEzdnpjNkUxQVVBOGpabVZMa0tNUVE5NURJTEhaTTJleS85OEFHClIxRElGSXVEdkpIZXlVYVQ0Z05QTjRZeHBaZ040aWJlOUM3SysrQ3RnbmVLRjMyOXdnbFZzSVRnTFkySU9RbnoKTkpYenlSWUkxZFRUMy9SdVFrZDVIU0NoMUxlRjg3ZVcxZnE1YVlReWhqYVllZHJ2NHlSQSswM1RGY2I5ZnBDZwpVelZzZ2VDZHV5OStYbnd6OTVrVGdpcmU3QktHN0x1em45bnRvRmtLdnNVYWVEcTc4eC9OYmFmNHdpbEFZNElsCnRnazlxbVErN1pHVHhJdDJ0V3k3S1NkVXlHV2FCWi8vUE9yZ1VleTdFN05xOWZEYnRYWTNwVldMaitZb1VYODQKRFNxSkdYSnFHenZxRkVFbHNNSkdnVmxqSWVzL1ZwR2l2NmhBQmtTeW92QmFQUGZxM2drRUx5QmRyYU9QaERWeQpGY3FIRktELzJHZU11QjRiUjdsTmJHeW9HT29KcXA0TUMyWVBvWlNRV1BKbXJUaUdQOGNDQXdFQUFRS0NBWUJmCkswSXNac1VZZURQU3RZQ1F4bEl6aUFsZDdlOXlqOWFxWUVBN2xIbmtqWC9jeDdGZWdjMkNmQmxCK2VwK2dQWGQKVGJZd0lvODNNM2szeHY4a2J1ZitzRnRVbDJwdGtIQVRrZ2hiYTJxUnRBVDFXV3JZdVZyMXNTaDNvMzc2YzlFcAp6QVd1RUJuN1lkSFg3MmVjNmlBL0l3OVk1VkZPMHpzc1BYR083eWFQZG0yT0JLVWtabG1JRU1tdklFRUFnUTNBCm9lTmwrc2NpcTlHMFFMV0hYL1NZcytYUXBQMHhpNnp6TE5xQ09QREFQZnplUm5oaEpqdXJob280ZlJFbi83ZHYKb1BiTHZBQmZUeEorYkJuTTI4cDEyNVcyQTQzOVpKbFRiVEx1NzI3WmhwNktKVU4vVVB3dFYvSVZSMmRHeUliNgp4c1pPamF4YVJYamxwMzJyZW80NndZRng1Ui9LazZHcEt4VEJ0TWcrT1BYK0lHVXNBV2JwT2E3eG9MOUtlbWZlCjJSOXF0R3hWUmVsUmJ0cDEwakZMaDltRWErTkVIVTF2TkdGOGw3dWM4QUkyNzZZQjlGUkF6MTFKR3NFaERJM2oKbnIvdVg3ZUZ5bUo5RDVTNzE4Tzh2SXhoblFsZHJ3TXNoRlRWQi9HWlpKb2ZiNDVxWWpJeElxbytFN1BScEhFQwpnY0VBeUoxR3N1VzVVNDQ2RVFtR2dkY0FKdGdsdklLZlpKd2k3U205bFh6aVpLdi9MeTdyaXA4UFNydlYvV3VQCmRTT3BlL0NKbUJLR0JXNjNnRTVlUnJTUTA2bDhJMW5vM1ZCeGM3NGhsMzN4RS9TbnMweHJSWE9nenpJYnN2RmoKVjN6dWxid2lmY0NOVmp3VUxDTS9DdHIwYlVJY2NmaHg0QTZJeVlVeWdwLzNqdXV1L2JoVW5ITHVJUUZyMVphawp6dTdYY0xaMUo1MWUyaW1nV3k4S0N1MWo5RFV3RVltQUtPNEx5bnBWU251WExMQ2s2cFZ1Qnk4UTE1RlVHRXQ2CkhUTXZBb0hCQVAzQlNESUQzUmJsdk1LQjZNTEdiK250NittSUw2RSsyeXVTclFmYnJiam5EM1AydDRSc29WVloKay9WMXdnbnVrY0dnd3VNMlhqQk9hSmhzbklCKzVHQ0UwSXlEZDJaK05VL3FzVVhpbEFsNDVQbi9ramdZZ2lUMgpEYVlEMStjZEdEZzJxNjVYUERVUDBvZCtIaGVCRDJkTG1CV2ZnV2duZHRJOCtna044Ym1Mc2ZlV2gyR0NoZGVDCk5TT2srZHdSengzcTVCZEZkZlFjcDhDU1c5NTF4cnZUMmxmNyt2Wno0eEw3MytiMUxwejMvRkJGdFZtcGV3MFQKNDR2VmJKVjI2UUtCd0NqQWtqa0xJMytPdDhyNE5XT3d5aTRaNEdpUDNGTXl5SUdHNWlVMHprU0hEL3FFdklKWApWMkxtRDAxQWlVN1JaTDl4bUhIVTZYYTNDLzI3YmJsTk90SlVib3c3Mm1zQ3lWa3F1V1l0eGtnNGZjeVZiSUVhClFRTjErVng3WHFQS0ZDbEVvM2tLSVd2d0htVHM4QVNEZi8ybDNXTmxoYlJ2SDJoWWIyOUxrWjF0MFFsblpZQzIKZEJzdVQ3cCt0Skg0d0xqN3g0YTVtQ2dYSnFUL1JEbitDVHoxaFFNNi9GYlVMSDhBSk0xUmw5OFRMeDBjSjlLNwp3OThXZlkvRjNWT0xMd0tCd0dWYkMzdzJ3TnVCZmdqdkhNcVh1bUhrejRNakMydExrUDF4ZzcyTXlISC9rTk9QCjZ6Tnd0R3hEOEc1dHo4aHB5enhjK3hzSVAwenFOS3NWVHRtZ1ZaWWIxclVaV2RyTmRIdnNVVXlKdVBtam1Vb20KQkFCMkFaM0R6aVhPaVRGZUZLdDNZdEdyTkhnNVRxMGgrZUVIZ3VDT2VEdkN6MHlMM3RFUTNBbzcwSjU5SnVPdQo4M3BHU1RHUVo2dEtIU2NDMGdpd0p0VUl3SmwxektlRmpqNW9LcTRoYTZnVEZPWFYyaEJlSE12Q2lSRFhtS2R6CmdJRkV5Y3FxZEF3SmZtcWc2UUtCd0J6RXZ6dWQwU2xMclV2K2d5cnZDNXk1QVZUTW5hSEdoU1JEcDF0YktWbTQKWGpuTXRPMUM1R0pQYVpiRWZSL0gvQUVUZkVsanhSS1EzZ0l5bjQ2RjAzbElNd0t6eGFiMzZSbFBHN0Y4Sm1xWgovSnNGYkdiVHBTVHhuS3NTY3Z2OElsdHZsNkhlVXFON0lpc1RFdk1odER6RFNWbTFtZFpPdFBBMVlWbXFNRkh5Ci9TSGYydm5qRTRHMVlBaU5zYmhXSk9lRVBVdVRHSjJxUXpwTmJoWXBhQUpob3ppU3p1WHJ3SDY3Rkt2QWNtWVAKUkNac3BkcnlneVNzeGNyeDk3Q0FLZz09Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVBakNDQW1xZ0F3SUJBZ0lSQU9kMG1IZEQ1a0gvSVg1cENQNUVTMWd3RFFZSktvWklodmNOQVFFTEJRQXcKVVRFZU1Cd0dBMVVFQ2hNVmJXdGpaWEowSUdSbGRtVnNiM0J0Wlc1MElFTkJNUk13RVFZRFZRUUxEQXB5YjI5MApRRzV2WkdVeE1Sb3dHQVlEVlFRRERCRnRhMk5sY25RZ2NtOXZkRUJ1YjJSbE1UQWVGdzB5TkRBMk1qWXdNakV4Ck5URmFGdzB5TmpBNU1qWXdNakV4TlRGYU1ENHhKekFsQmdOVkJBb1RIbTFyWTJWeWRDQmtaWFpsYkc5d2JXVnUKZENCalpYSjBhV1pwWTJGMFpURVRNQkVHQTFVRUN3d0tjbTl2ZEVCdWIyUmxNVENDQVNJd0RRWUpLb1pJaHZjTgpBUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBT1JpbUkrQ1U4NkV4OXJIaEJUVVNBVUhVQVV1WE5qNjFoQWxla1B5CklJRkVBTkc0OUo3ZGtuTGk0U1lCWEhFeWNiYi82d3REa1g4R3YyR1BhbnVCYTBMbmw3SnBiTVdON3M2bjBybEoKemJkY3E2N1lCWU9MdGViU0k1cW5PblB4cHFLZ2tZRVlPT1ZmUW8zR055TXp3Ull4VnNsRUk4bTNmdGhxTWhpNQpuRHkyVUxoMEhPWWNnZzI2VUhHTklwR1M2TytPNE9XN0hKOXNPdTNqaFBHNVE3UTVXOG9CTURqWjllQWtKMjRzCnZnS3JuT1NjSGIxdG95OTZBNEJCT1lmYWRZZWpzVjJQTEhhUkdpSVRWM2Ywb0M1NElieGk4R2JoeVFvZEo1VUEKRjdVZ2ZLaGlBT3VIV01sV3hCVHRnK3hFQ2dvWEFTQ2NvTWtVY2V1aXRubWdDek1DQXdFQUFhTm9NR1l3RGdZRApWUjBQQVFIL0JBUURBZ1dnTUJNR0ExVWRKUVFNTUFvR0NDc0dBUVVGQndNQk1COEdBMVVkSXdRWU1CYUFGUDFqClpRQUZybFZTSnhlUU5neVd6Z2QvRHA5dU1CNEdBMVVkRVFRWE1CV0NEU291WkdWMlpXeHZjQzVqYjIySEJIOEEKQUFFd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dHQkFHVjV2MWQ0bDQ0dmJXY0NXWmhMMWc1OW1iM2prUWg4d0ZNTwpWK3p3RXlrZjIvaUg4dGRPbjF0cC9NUmFzMzRnYTM0dHNtUWF4Z1NpYXo4cHUvNnJjcEtJRXROWUM5aFI5VzZNCkMza2l3di9XNWw1akRYYzZMSVFrUEovLzdOVTZSaEkyNStQL25TWUhyN3ZJOVl3WTV0Um5LVkdmRDhUODNhbU0KY0p0Yjg2UmNhL2RkU09VMjhaVm5ENlVSbUpCSk5idlUwMWxnY0lBdXZDREFNV1Q3QWNzYUVITDBscEJlTnpKLwpyUTZqMGNHR2lIR0U5QllMWUZzamRTTlNjRmNPYmlOdlBuS0pVMCtkZVlaU29vS2QvZ0xKelhld2FVczlkS1h6ClFpMGZ5UVNlNXMwRDh1RHB2WXZMSGlvTnh4ZUhyK0VHN0ZJeXNITnFXNkFnOEExYllZUWdEY21NbDROcE5JNEsKelowVE9OVGtCVWVNOW1oYXVmRjF0eEdnM05HVTA1T2JDTG9MVGZrZUoyOUp1V25yeGtQakZoYTZmQlEzUXRiYQpyMC92VzRMbEVrL29rcUN1RjVoeExpVjVRdlpnU3V2bWdOdkc4Y0hoa29MdmFXeXBhZFpKN1hGaUVLMUplenFXCmJOR2kvcHdPMERtQ1hwd1Rod3A2dGczVHQ2Ujk2Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2Z0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktnd2dnU2tBZ0VBQW9JQkFRRGtZcGlQZ2xQT2hNZmEKeDRRVTFFZ0ZCMUFGTGx6WSt0WVFKWHBEOGlDQlJBRFJ1UFNlM1pKeTR1RW1BVnh4TW5HMi8rc0xRNUYvQnI5aApqMnA3Z1d0QzU1ZXlhV3pGamU3T3A5SzVTYzIzWEt1dTJBV0RpN1htMGlPYXB6cHo4YWFpb0pHQkdEamxYMEtOCnhqY2pNOEVXTVZiSlJDUEp0MzdZYWpJWXVadzh0bEM0ZEJ6bUhJSU51bEJ4alNLUmt1anZqdURsdXh5ZmJEcnQKNDRUeHVVTzBPVnZLQVRBNDJmWGdKQ2R1TEw0Q3E1emtuQjI5YmFNdmVnT0FRVG1IMm5XSG83RmRqeXgya1JvaQpFMWQzOUtBdWVDRzhZdkJtNGNrS0hTZVZBQmUxSUh5b1lnRHJoMWpKVnNRVTdZUHNSQW9LRndFZ25LREpGSEhyCm9yWjVvQXN6QWdNQkFBRUNnZ0VCQU5STWx0YW9ackZPR3QzVG80TWRSZ2x1bjhNQk13djhPQ3J3TzdTWGlnRy8KcmlkR0VCYnhqeVkrb3Q2S1cxMWFiL3lWN3U4Y2swNktmakw1ZHhseDE3eHN2a1g1M0VQVVNVNVBFUUp1aWMxTwpWc1dFUjdQZGxtMEhvRk10NnBkRzVnaTh6Q1U5MS8zWVRHeXYraWM5LzlwYWFQdFUzUk94QURlNmwvRUY4U2M0CjdONlNTM2V2ajFQV0dMUEFTSEpSZk1uTGNQeXY2RWFrNGtpb3ZsRlNHSXF3THo1UWtrMWVkeTM2UGJXYzVaVEIKUHFSUjRaTklRSkt0SnhmTTJhRitmZElVcUY3OHZtV05RK003aUo1NGMrZmk5dmJ0ZzVZRi9aSFBPQmN1cXlPSApNVzZLdThMeE44MU83YXZEQjZsTGRIQkRoKzZtWmZjQzJPYVhyamhtenZrQ2dZRUE1NEpCRHhydjIyZmFNMWlmCmdpQ0dZV21zMUZ1UVprQmVaOXBUOXVhZWF4cllCeEZZMlVQT2lGdmhlSGxBc28vazFLbHZKTHFPRXlvdjRPam8KTCtaV09FSTFOemxGY3BpVWtFUDVkMm1UejZGam51OW1qdkthSW9NalhyNDUwYlR3SVNsRE9lOGZQeTRVNHpMUgpvL2Q2UjFaeHRTWk5sRm54VVArV3hTTmplUWNDZ1lFQS9JdS9FdklSekpFTlRCbG1JSXZWZEpRVXhqTDhLVFc4CjF6blNRNmtkK1J1azZ6ZytrN2lDWGlPWnZhK1lybTlYQU1DSWlMbDZvYVVUK0Y5TXNhMmVSMkVVYkVBNlNqWFEKS0Z2Ri9nUi9vK0JnUGpKWUg5WE9NNGNKRW9uOVNGbFM1QlcxVUhjZVNUQ0hHTGtQS0VVV04wRU9tUlVmRkFyagpFam1wa1JDZ3JYVUNnWUFnelgzMmEvU3NlK3lZOWVlMEFuUEgvYmMxWjd2d0lSSy9XRm9wVThnQ21RMGZBMEE1Cm1MZjg3amZtWUJmZ3RTN1JTeWlxWlp5WDdwUldJK295VDByTU1lVmthOE1CVjhsRkg3eUxSUFJpcVJWNmdhVmcKZjlPRExGMm9vUCtFVFVUeERlMnVtY2t0cEpQbEZXQkxBVmZjSDgyQXcycWVxSmZleURoT3VwTHZwUUtCZ0RRcQpKWGlqV2J2WWhsZWVzM0tyajVhNTg2U1E2WGNWcTRFRlo0SWtUNVdoK1NuQS8yUUI2NlBJVkx4U3BnWDU1NDIzCk56eU9tMThDT3lMRmhKRDYzTU8vc0xrL2R3clhITDBKWDljOVZLUWo5NTFCUnVTa2hDZ3VqMWd0K294VUx3UC8KMitqWUFnQjZMcDJUdENiTVJtOTVWNnVWS2tzNGlIaStRbUU5ZndMMUFvR0JBTURjRzE1WmxxUlhZbUQ3RUNKagpHMmZKMzUyaWYxclZFLyt0czlLVVVCVnN5bUdrNGRXQ3lUZHFGQWJobUtWV2h5ekVrQlllUDlYVU5zVE5jSkRGCkZiMkFzaXBUNTZsaGRBNCsxa1lqbXlUejBFaXZmTExvWWRPUmt1ZExsKzVXNnpRQzgvR0RtMVJvRmcvWEw2eWEKaWxTbjZBWmlKc0hjL1FJM0p4eW0xSzlECi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K

